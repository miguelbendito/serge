{% include "header.html" %}

<!-- HERO -->
<header
  class="masthead min-vh-100 d-flex align-items-end position-relative menu-detail-hero"
  style="background-image: url('{{ menu.img_url if menu.img_url else url_for('static', filename='assets/img/menus_bg.jpg') }}');"
>
  <div class="hero-overlay hero-overlay-dark"></div>

  <div class="container position-relative px-4 px-lg-5 pb-5">
    <div class="row">
      <div class="col-md-10 col-lg-8">
        <div class="site-heading text-start text-white">
          <h1>{{ menu.title }}</h1>
          {% if menu.subtitle %}
          <span class="subheading">{{ menu.subtitle }}</span>
          {% endif %}
        </div>
      </div>
    </div>

    <div class="menu-back-link">
      <a href="{{ url_for('menus') }}">
        Back to Menus
      </a>
    </div>
  </div>
</header>

{% if not menu.is_active and current_user.is_authenticated and current_user.id == 1 %}
<div class="menu-admin-banner">
  <i class="fas fa-eye-slash me-2"></i>
  Hidden menu (visible to admin only)
</div>
{% endif %}

<!-- MENU DETAIL CONTENT -->
<section class="menu-detail-section overlap-hero">
  <div class="container px-4 px-lg-5">

    <!-- CATEGORY NAV -->
    <div class="menu-category-nav sticky-top">
      {% for section in menu.sections|sort(attribute='order') %}
        <a href="#section-{{ section.id }}" class="category-link" data-target="section-{{ section.id }}">
          {{ section.title }}
        </a>
      {% endfor %}
    </div>

    <div class="menu-detail-frame">

      {% for section in menu.sections|sort(attribute='order') %}
      <div id="section-{{ section.id }}" class="menu-section-container text-center"
           style="scroll-margin-top: 160px;">

        <h2 class="menu-section-title">{{ section.title }}</h2>

        {% if section.subtitle %}
        <span class="menu-section-subtitle">{{ section.subtitle }}</span>
        {% endif %}

        <div class="row text-start mt-5">
          {% for item in section.items|sort(attribute='order') %}
          <div class="col-lg-6 mb-5">
            <div class="d-flex justify-content-between align-items-baseline mb-2">
              <h4 class="menu-item-name">{{ item.name }}</h4>
              {% if item.price %}
              <span class="menu-item-price">{{ item.price }}</span>
              {% endif %}
            </div>
            <div class="menu-item-desc">
              {{ item.description|safe }}
            </div>
          </div>
          {% endfor %}
        </div>

      </div>
      {% endfor %}

    </div>

    <!-- EXPLORE OTHER MENUS -->
<div class="menu-explore mt-6">
  <h3>Explore Other Menus</h3>

  <div id="menuCarousel" class="carousel slide" data-bs-ride="carousel">
    <div class="carousel-inner">

      {% for m in all_menus if m.id != menu.id %}
      <div class="carousel-item {% if loop.first %}active{% endif %}">
        <a href="{{ url_for('menu_detail', slug=m.slug) }}"
           class="menu-carousel-card">

          <div class="menu-carousel-image">
            <img
              src="{{ m.img_url or url_for('static', filename='assets/img/menus_bg.jpg') }}"
              alt="{{ m.title }}"
            >
          </div>

          <span class="menu-carousel-title">{{ m.title }}</span>
        </a>
      </div>
      {% endfor %}

    </div>

    <button class="carousel-control-prev" type="button"
            data-bs-target="#menuCarousel" data-bs-slide="prev">
      <span class="carousel-control-prev-icon"></span>
    </button>

    <button class="carousel-control-next" type="button"
            data-bs-target="#menuCarousel" data-bs-slide="next">
      <span class="carousel-control-next-icon"></span>
    </button>
  </div>
</div>

</section>

{% include "footer.html" %}
